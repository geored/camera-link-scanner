<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Link Scanner</title>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Camera Link Scanner">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="LinkScanner">
    <meta name="description" content="OCR web app to detect and open links from camera input">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="assets/icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="assets/icons/icon-512.png">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">
    
    <!-- Styles -->
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <div class="container">
        <video id="video" autoplay muted playsinline></video>
        <div id="overlay" class="overlay"></div>
        
        <div id="selectionOverlay" class="selection-overlay">
            <div id="selectionInstructions" class="selection-instructions">
                üì± Drag to select text region for OCR<br>
                <small>Click Cancel button to exit</small>
            </div>
            <div id="selectionBox" class="selection-box"></div>
        </div>
        
        <div class="top-row">
            <div id="status" class="status">Initializing camera...</div>
            <div id="performanceInfo" class="performance-info">OCR: Ready</div>
            <div class="region-controls">
                <button id="selectRegionBtn" class="region-btn">üì± Select Region</button>
                <button id="cancelRegionBtn" class="region-btn" style="display: none;">‚ùå Cancel</button>
            </div>
            <button id="configToggle" class="config-toggle">‚öôÔ∏è AI Config</button>
        </div>
        
        <div id="aiConfig" class="ai-config">
            <h3>ü§ñ AI Vision Settings</h3>
            
            <div class="ai-provider-select">
                <button class="provider-btn active" data-provider="free-ocr">‚ö° Free OCR</button>
                <button class="provider-btn" data-provider="azure">Azure Vision</button>
                <button class="provider-btn" data-provider="ollama">Ollama Local</button>
                <button class="provider-btn" data-provider="enhanced">Enhanced OCR</button>
                <button class="provider-btn" data-provider="google">Google Vision</button>
                <button class="provider-btn" data-provider="openai">GPT-4 Vision</button>
                <button class="provider-btn" data-provider="tesseract">Tesseract OCR</button>
            </div>
            
            <div id="googleConfig">
                <label style="color: #ccc; font-size: 12px;">Google Vision API Key:</label>
                <input type="password" class="api-key-input" id="googleApiKey" placeholder="Enter Google Vision API key">
                <div style="font-size: 10px; color: #888; margin-top: 5px;">
                    1000 free requests/month ‚Ä¢ 1-2s response ‚Ä¢ 95% accuracy
                </div>
            </div>
            
            <div id="openaiConfig" style="display: none;">
                <label style="color: #ccc; font-size: 12px;">OpenAI API Key:</label>
                <input type="password" class="api-key-input" id="openaiApiKey" placeholder="Enter OpenAI API key">
                <div style="font-size: 10px; color: #888; margin-top: 5px;">
                    $0.01 per image ‚Ä¢ 2-4s response ‚Ä¢ 98% accuracy
                </div>
            </div>
            
            <div id="enhancedConfig" style="display: none;">
                <div style="font-size: 12px; color: #888;">
                    Enhanced Tesseract ‚Ä¢ 1-2s response ‚Ä¢ 85% accuracy ‚Ä¢ Advanced image processing
                </div>
            </div>
            
            <div id="freeOcrConfig" style="display: block;">
                <div style="font-size: 12px; color: #888;">
                    ‚ö° Free Cloud OCR ‚Ä¢ OCR.space API ‚Ä¢ 1-2s response ‚Ä¢ 85% accuracy ‚Ä¢ No setup needed
                </div>
                <div style="font-size: 10px; color: #4CAF50; margin-top: 5px;">
                    ‚úÖ ACTIVE: 10 free scans per 10 minutes. Use "Scan for Links" button or region selection.
                </div>
                <div style="font-size: 10px; color: #FFA500; margin-top: 3px;">
                    üí° For unlimited scanning, use Azure Vision (5K free/month) with your own API key
                </div>
            </div>

            <div id="transformersConfig" style="display: none;">
                <div style="font-size: 12px; color: #888;">
                    üî• Advanced AI OCR ‚Ä¢ Browser-based TrOCR ‚Ä¢ 90% accuracy ‚Ä¢ No API needed
                </div>
                <div style="font-size: 10px; color: #FFA500; margin-top: 5px;">
                    ‚ö†Ô∏è Large downloads (300MB+) - may timeout. Use Free OCR instead.
                </div>
            </div>
            
            <div id="azureConfig" style="display: none;">
                <label style="color: #ccc; font-size: 12px;">Azure API Key:</label>
                <input type="password" class="api-key-input" id="azureApiKey" placeholder="Enter Azure Computer Vision API key">
                <label style="color: #ccc; font-size: 12px; margin-top: 8px;">Azure Endpoint:</label>
                <input type="text" class="api-key-input" id="azureEndpoint" placeholder="https://your-resource.cognitiveservices.azure.com">
                <div style="font-size: 10px; color: #888; margin-top: 5px;">
                    5000 free requests/month ‚Ä¢ 1-2s response ‚Ä¢ 95% accuracy
                </div>
            </div>
            
            <div id="ollamaConfig" style="display: none;">
                <label style="color: #ccc; font-size: 12px;">Ollama Endpoint:</label>
                <input type="text" class="api-key-input" id="ollamaEndpoint" placeholder="http://localhost:11434">
                <label style="color: #ccc; font-size: 12px; margin-top: 8px;">Model:</label>
                <input type="text" class="api-key-input" id="ollamaModel" placeholder="llava:7b">
                <div style="font-size: 10px; color: #888; margin-top: 5px;">
                    üè† Local AI ‚Ä¢ Completely free ‚Ä¢ 2-5s response ‚Ä¢ 95% accuracy ‚Ä¢ Privacy-first
                </div>
                <div style="font-size: 10px; color: #FFA500; margin-top: 3px;">
                    Setup: 1) ollama pull llava:7b<br>
                    2) OLLAMA_ORIGINS=https://geored.github.io ollama serve
                </div>
                <div style="font-size: 9px; color: #666; margin-top: 2px;">
                    CORS fix required for web access
                </div>
            </div>

            <div id="tesseractConfig" style="display: none;">
                <div style="font-size: 12px; color: #888;">
                    Free local processing ‚Ä¢ 2-3s response ‚Ä¢ 70% accuracy
                </div>
            </div>
        </div>
        
        <div id="linksPanel" class="links-panel">
            <div class="links-header">
                <span>üì± Link History</span>
                <button id="clearHistory" class="clear-history">Clear</button>
            </div>
            <div id="linksList"></div>
        </div>
        
        
        <div class="controls">
            <button id="scanBtn" disabled>Scan</button>
            <button id="toggleCamera">Camera</button>
        </div>
    </div>

    <!-- Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    
    <!-- OCR Providers -->
    <script src="src/providers/enhanced-ocr.js"></script>
    <script src="src/providers/ai-vision.js"></script>
    <script src="src/providers/transformers-ocr.js"></script>
    <script src="src/providers/azure-ocr.js"></script>
    <script src="src/providers/ollama-ocr.js"></script>
    <script src="src/providers/free-ocr.js"></script>
    
    <!-- Utilities -->
    <script src="src/utils/URLExtractor.js"></script>
    <script src="src/utils/PerformanceMonitor.js"></script>
    
    <!-- Components -->
    <script src="src/components/CameraManager.js"></script>
    <script src="src/components/LinkManager.js"></script>
    <script src="src/components/RegionSelector.js"></script>
    <script src="src/components/UIController.js"></script>
    <script src="src/components/ProviderManager.js"></script>
    
    <!-- Main Application -->
    <script src="src/js/main.js"></script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(function(registration) {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(function(err) {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>
</body>
</html>